<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Failing at pushing a Wikipedia trending API</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Failing at pushing a Wikipedia trending API</h1>
</header>
<section data-field="subtitle" class="p-summary">
It was 2016, and a lot of famous people were about to unexpectedly die — including the awe-inspiring David Bowie. I knew within minutes…
</section>
<section data-field="body" class="e-content">
<section name="319c" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="03f5" id="03f5" class="graf graf--h3 graf--leading graf--title">Failing at pushing a Wikipedia trending API</h3><p name="9491" id="9491" class="graf graf--p graf-after--h3">It was 2016, and <a href="http://www.bbc.com/news/magazine-38418802" data-href="http://www.bbc.com/news/magazine-38418802" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">a lot of famous people were about to unexpectedly die</a> — including the awe-inspiring David Bowie. I knew within minutes about his passing, but not from where you’d expect.</p><p name="78d8" id="78d8" class="graf graf--p graf-after--p">My phone beeped to tell me there had been a flurry of edits on Bowie’s Wikipedia article. After a brief read of the first paragraph, I realized that Bowie was dead.</p><p name="72e9" id="72e9" class="graf graf--p graf-after--p">That alert in the saddest way possible confirmed a hypothesis that I had recently set out to answer: could I catch trending topics on Wikipedia by looking at the edit activity on articles?</p><figure name="f4f4" id="f4f4" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 500px; max-height: 479px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 95.8%;"></div><img class="graf-image" data-image-id="1*ndIJ7eOONbffrRiZJxZ3iQ.png" data-width="500" data-height="479" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*ndIJ7eOONbffrRiZJxZ3iQ.png"></div><figcaption class="imageCaption">David Bowie was many of the notable people to die in 2016 [Source: <a href="https://commons.wikimedia.org/wiki/File:David_Bowie_-_TopPop_1974_10.png" data-href="https://commons.wikimedia.org/wiki/File:David_Bowie_-_TopPop_1974_10.png" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Wikimedia Commons</a>].</figcaption></figure><p name="f8b2" id="f8b2" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Inception</strong></p><p name="d5b9" id="d5b9" class="graf graf--p graf-after--p">Anticipating an upcoming release to Mozilla Firefox (which would include the <a href="https://www.w3.org/TR/push-api/" data-href="https://www.w3.org/TR/push-api/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">web push standard</a>), I had built a service to monitor edits to Wikipedia and send me notifications of unusual activity. My service watched all the edits over the course of that day, using the <a href="https://wikitech.wikimedia.org/wiki/EventStreams" data-href="https://wikitech.wikimedia.org/wiki/EventStreams" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Wikipedia EventStream API</a>, storing them in an object in memory which I purged periodically based on how many edits were made per minute. I gave each of those articles in memory a trending “score”, and called the early prototype “Pushipedia”.</p><p name="eabc" id="eabc" class="graf graf--p graf-after--p">When the score exceeded a certain value — meaning lots of people were editing a particular article — it would ping my phone.</p><p name="a576" id="a576" class="graf graf--p graf-after--p">This became a huge source of news for me informing me about things I otherwise may have missed. Since it’s inception in 2016, I was to learn within the hour of the passing of notable people including <a href="https://en.m.wikipedia.org/wiki/Fidel_Castro" data-href="https://en.m.wikipedia.org/wiki/Fidel_Castro" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Fidel Castro</a> and <a href="https://en.m.wikipedia.org/wiki/Carrie_Fisher" data-href="https://en.m.wikipedia.org/wiki/Carrie_Fisher" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Carrie Fisher</a>; <a href="https://en.wikipedia.org/wiki/Joseph_Schooling" data-href="https://en.wikipedia.org/wiki/Joseph_Schooling" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Singapore’s first ever Olympic Gold medal</a>; important scientific discoveries such as <a href="https://en.wikipedia.org/wiki/First_observation_of_gravitational_waves" data-href="https://en.wikipedia.org/wiki/First_observation_of_gravitational_waves" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Gravitational wave detection</a>; world events such as <a href="https://en.wikipedia.org/wiki/Catalan_independence_movement" data-href="https://en.wikipedia.org/wiki/Catalan_independence_movement" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Catalan independence</a> the latest movie releases and an extensible knowledge of the happenings in <a href="https://en.wikipedia.org/wiki/WWE" data-href="https://en.wikipedia.org/wiki/WWE" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">WWE</a> (it turns out many of our editors love the sport).</p><p name="2307" id="2307" class="graf graf--p graf-after--p">But you’ve probably never heard of all this, because the project failed.</p><figure name="fbe1" id="fbe1" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 1440px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 205.7%;"></div><img class="graf-image" data-image-id="0*60Y0KaWI1f-cWw7B." data-width="778" data-height="1600" src="https://cdn-images-1.medium.com/max/800/0*60Y0KaWI1f-cWw7B."></div><figcaption class="imageCaption"><em class="markup--em markup--figure-em">That moment you realise something important may be happening in Catalonia.</em></figcaption></figure><p name="85db" id="85db" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Iterating on the push</strong></p><p name="5bfc" id="5bfc" class="graf graf--p graf-after--p">The Pushipedia prototype has gone through many iterations. In 2016, I worked on a <a href="https://github.com/jdlrobson/weekipedia" data-href="https://github.com/jdlrobson/weekipedia" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">reimagined prototype of the Wikipedia mobile website</a> and incorporated the ideas of Pushipedia.</p><p name="5428" id="5428" class="graf graf--p graf-after--p">The web version, is <a href="https://trending.wmflabs.org/" data-href="https://trending.wmflabs.org/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">still running</a> and has augmented itself into my morning routine (every morning, my wife will ask me “what’s trending”). Seeing the trending articles of the day in such a visible UI however only helped me see the algorithm’s flaws and drove an obsession to make it better.</p><p name="fa5f" id="fa5f" class="graf graf--p graf-after--p">For example, there were situations where an article would trend even though a single editor would make 90% of the edits. There were situations where two editors would edit war back and forth and things would trend despite no real new content being added. Vandals would make an article trend up, until an article was protected against their edits. Anonymous editors would change their IP address and give the allusion that multiple people were collaborating on a single article. I worked out an algorithm to deal with these difficulties.</p><p name="6898" id="6898" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Failing to push Pushipedia</strong></p><p name="daac" id="daac" class="graf graf--p graf-after--p">My experiments caught the attention of other members of my team, and in 2017 we explored incorporate my ideas into the official Wikipedia iOS app. Instead of the push notification use I envisioned, a decision was to do something far simpler — incorporate the more timely information into the <a href="https://blog.wikimedia.org/2016/03/10/new-wikipedia-app-ios/" data-href="https://blog.wikimedia.org/2016/03/10/new-wikipedia-app-ios/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Wikipedia iOS feed</a>.</p><p name="5747" id="5747" class="graf graf--p graf-after--p">I was tasked with rewriting the service with this new use case in mind, but the plans sadly fell through after some design research showed that users <a href="https://meta.wikimedia.org/wiki/Research:Comparing_most_read_and_trending_edits_for_Top_Articles_feature" data-href="https://meta.wikimedia.org/wiki/Research:Comparing_most_read_and_trending_edits_for_Top_Articles_feature" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">preferred to view articles based on pageviews</a>. In India particularly, the content was not as familiar. With this use case gone, there was no “customer” and the priority of this work dropped. Struggling to find a home for it and falling into neglect, the service rightly and <a href="https://phabricator.wikimedia.org/T180384" data-href="https://phabricator.wikimedia.org/T180384" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">responsibly got shut down</a>.</p><p name="814b" id="814b" class="graf graf--p graf-after--p">I was of course disappointed about this. I’m sure many developers have experienced the pain of building something you love only to see it never see the light of day. Failure sucks, but failure is normal. Everyone fails.</p><p name="1123" id="1123" class="graf graf--p graf-after--p">I could have dwelled on this, but this wasn’t the first failure I’ve experienced. Back in 2015, my team attempted to build out a reading list feature for end users that despite being popular with readers <a href="https://www.mediawiki.org/wiki/Talk:Gather" data-href="https://www.mediawiki.org/wiki/Talk:Gather" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">was badly received by the editing community and eventually shut down</a>. I was able to appreciate why this failed — ultimately this project was too ambitious; underestimated the importance of editor buy-in; and didn’t prioritise moderation of public reading lists. Based on these lessons, this year, we <a href="https://www.mediawiki.org/wiki/Wikimedia_Apps/Synced_Reading_Lists" data-href="https://www.mediawiki.org/wiki/Wikimedia_Apps/Synced_Reading_Lists" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">recently successfully launched a private reading list feature</a> to our mobile apps.</p><p name="a9e4" id="a9e4" class="graf graf--p graf-after--p">Failure has been an important lesson for me during my time at the Wikimedia Foundation. Failure is normal. What’s important is how you learn and respond to it.</p><p name="7e97" id="7e97" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Finding a home</strong></p><p name="e08d" id="e08d" class="graf graf--p graf-after--p">Despite its failure and understanding why it failed — an unclear use case; more important initiatives; not enough available resourcing — I still believe in this project.</p><p name="2fcc" id="2fcc" class="graf graf--p graf-after--p">Currently Wikipedia is very much seen as a secondary destination that you get to from Google or Twitter but this trending endpoint gave me hope that it could be much more. I couldn’t find it a home in the Wikimedia Foundation and in our core products, but as a volunteer I could continue to work on this tool.</p><p name="1ca7" id="1ca7" class="graf graf--p graf-after--p">I believe the Wikimedia movement can be a good compass for what’s important to the world, especially in a time of “fake news”. It’s not perfect — during the 2016 Olympics I noticed many male dominated events trended whereas the female equivalent didn’t and at times in 2016, the buzz of my phone telling me I had a push notification made me anxious wondering which of my heroes had died this time and I was scared to look at it. It was a rollercoaster with highs and lows, but most of the time it was positive and it was one of the things I was more proud of building.</p><p name="be8d" id="be8d" class="graf graf--p graf-after--p">Nevertheless, I was given lots of feedback by users. One of the main sources of feedback was that it was not always clear why something was trending. At one point, something unusual was trending — <a href="https://en.wikipedia.org/wiki/100_Women_%28BBC%29" data-href="https://en.wikipedia.org/wiki/100_Women_(BBC)" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">BBC 100 Women 2016</a> — while potentially not “breaking news” it was interesting to know this was happening and with a little investigation I discovered an <a href="http://www.bbc.com/news/technology-38219838" data-href="http://www.bbc.com/news/technology-38219838" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">editathon was happening</a>, however to another user it was just noise. One of my guinea pigs playing with the service complained about the constant vandalism they were getting told about, while another — a regular editor — told me they loved the fact they got vandalism and could jump in and fix it. You can’t make everyone happy.</p><figure name="f8ea" id="f8ea" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 645px; max-height: 508px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 78.8%;"></div><img class="graf-image" data-image-id="0*XZCL5hQSbMrRKrLg." data-width="645" data-height="508" src="https://cdn-images-1.medium.com/max/800/0*XZCL5hQSbMrRKrLg."></div><figcaption class="imageCaption">One of the highs of February 2016 was the first observation of <a href="https://en.wikipedia.org/wiki/First_observation_of_gravitational_waves" data-href="https://en.wikipedia.org/wiki/First_observation_of_gravitational_waves" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">gravitational waves</a>.</figcaption></figure><p name="eb17" id="eb17" class="graf graf--p graf-after--figure">I think this is why it never found a home — there are too many things you could do with such a service — just like there are so many rabbit holes you can go down while reading Wikipedia. One person’s joy is not another, so while someone may enjoy spending hours on Wikipedia reading about World War II, maybe another wants to read about all the television shows on Netflix. For this purpose, I think it needs a special home.</p><p name="b231" id="b231" class="graf graf--p graf-after--p"><a href="https://en.wikipedia.org/wiki/IFTTT" data-href="https://en.wikipedia.org/wiki/IFTTT" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">IFTTT.com</a> is a free web-based service that allows non-developers to chain services across the web to creatively create new services. As of today, you can now use the <a href="https://ifttt.com/applets/MizSfWT6-if-an-article-is-trending-on-wikipedia-then-send-a-rich-notification-from-the-ifttt-app" data-href="https://ifttt.com/applets/MizSfWT6-if-an-article-is-trending-on-wikipedia-then-send-a-rich-notification-from-the-ifttt-app" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Trending service</a> as one of the many available <a href="https://ifttt.com/wikipedia" data-href="https://ifttt.com/wikipedia" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Wikipedia services</a>. The service can be linked to email, Twitter, Pinterest and all sorts of other services — including smart devices. You can make a light bulb flash every time the <a href="https://en.m.wikipedia.org/wiki/Deaths_in_2018" data-href="https://en.m.wikipedia.org/wiki/Deaths_in_2018" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Deaths in 2018</a> page trends or receive a <a href="https://ifttt.com/applets/MizSfWT6-if-an-article-is-trending-on-wikipedia-then-send-a-rich-notification-from-the-ifttt-app" data-href="https://ifttt.com/applets/MizSfWT6-if-an-article-is-trending-on-wikipedia-then-send-a-rich-notification-from-the-ifttt-app" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">push notification</a> or <a href="https://ifttt.com/applets/gDsBZ2Ec-send-me-an-email-when-a-wikipedia-article-gets-significant-edit-activity" data-href="https://ifttt.com/applets/gDsBZ2Ec-send-me-an-email-when-a-wikipedia-article-gets-significant-edit-activity" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">email</a> for all unusual edit activity.</p><p name="d393" id="d393" class="graf graf--p graf-after--p">I’m excited to hear what creative use cases users are able to use it for and hope that those who do will find the joy that I have long enjoyed through it.</p><figure name="9bef" id="9bef" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 464px; max-height: 710px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 153%;"></div><img class="graf-image" data-image-id="1*gC5yUJ7Np6swXg7n7C2QfA.png" data-width="464" data-height="710" src="https://cdn-images-1.medium.com/max/800/1*gC5yUJ7Np6swXg7n7C2QfA.png"></div><figcaption class="imageCaption">The new trigger gives you freedom to get creative.</figcaption></figure><p name="cd53" id="cd53" class="graf graf--p graf-after--figure graf--trailing">Maybe with use, it will find somewhere more permanent, but out of my failure, I hope others can find the joy that is the trending rollercoaster. If you love something let it go, hopefully it will go somewhere even higher.</p></div></div></section><section name="5545" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="7377" id="7377" class="graf graf--h3 graf--leading"><strong class="markup--strong markup--h3-strong">Developer afterthoughts</strong></h3><p name="f9bc" id="f9bc" class="graf graf--p graf-after--h3">To provide more context for the service, here I will go into a little more detail about the interesting technical aspects of this project.</p><h4 name="fa0b" id="fa0b" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">Algorithm</strong></h4><p name="3473" id="3473" class="graf graf--p graf-after--h4">The algorithm for the trending service, was mostly through trial and error through examples I found. If I could go back in time, I would probably have fun “machine learning” it, but at the time, it was a fun distraction to immerse myself in the “pulse” of Wikipedia’s many editors and get close to what was driving them to edit. In a way, I felt like I was tapping into the heartbeat of a global population.</p><p name="7463" id="7463" class="graf graf--p graf-after--p">I made various tweaks to the algorithm over the years on a variety of variables:</p><ul class="postList"><li name="3ae0" id="3ae0" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Number of edits</strong> was ultimately one of the more important variables. An article needs lots of them in a given <strong class="markup--strong markup--li-strong">timeframe </strong>to trend.</li><li name="45f0" id="45f0" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Number of editors</strong> was equally important. The more people that collect around an article, the more notable it might be.</li><li name="4875" id="4875" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">The ratio of named to anonymous editors </strong>it was also essential for the ratio of users who made an edit with an account outnumbered those without one (it turns out when something important is happening there is credibility in having your name associated with “breaking” the story).</li><li name="1ae0" id="1ae0" class="graf graf--li graf-after--li">Not only were number of editors important, but I needed to inspect the distribution of edits and work out a <strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">bias</em></strong>. For instance, a single editor making 15 edits and two other editors making a single edit each was less notable than 3 editors making 6 edits each.</li><li name="0668" id="0668" class="graf graf--li graf-after--li">The <strong class="markup--strong markup--li-strong">number of bytes</strong> that changed hands during a series of edit transactions helped me weed out a lot of the vandalism that was occurring (if a vandal removed a whole section of content and another editor added it back verbatim the bytes changed was zero).</li><li name="48aa" id="48aa" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Reverts </strong>were equally important, but annoyingly these are not easily countable — a revert is just a normal edit in the software that powers Wikipedia, so relying on de-facto standards in the summary message that accompanied an edit was the best I could come up with. I also scanned this message for key word indications that vandalism was going on. If this happened I incremented a <strong class="markup--strong markup--li-strong">flagged edits </strong>counter<strong class="markup--strong markup--li-strong">.</strong></li><li name="94c0" id="94c0" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Number of page views</strong> — I experimented briefly with looking at the number of page views an article had the day before. I figured if something was being read the day before, people were already aware of the article and it was no longer something that could be considered trending</li></ul><p name="bc9c" id="bc9c" class="graf graf--p graf-after--li">The algorithm I ended up with is immortalized in my <a href="https://github.com/jdlrobson/wikipedia-edits-scorer/blob/master/index.js" data-href="https://github.com/jdlrobson/wikipedia-edits-scorer/blob/master/index.js" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">wikipedia-edits-scorer GitHub</a> for those interested and as with all our software is open source and free to use.</p><p name="0080" id="0080" class="graf graf--p graf-after--p">Midway through building my algorithm I was pointed on Twitter to some research that was done in <a href="https://arxiv.org/pdf/1303.4702.pdf" data-href="https://arxiv.org/pdf/1303.4702.pdf" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">2013</a> and <a href="https://arxiv.org/pdf/1403.4289.pdf" data-href="https://arxiv.org/pdf/1403.4289.pdf" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">2014</a> by <a href="https://twitter.com/tomayac" data-href="https://twitter.com/tomayac" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Thomas Steiner</a> which explored the theme of using Wikipedia for breaking news stories. This research explored many of the same themes and visualizes such changes in the <a href="http://wikipedia-live-monitor.herokuapp.com/" data-href="http://wikipedia-live-monitor.herokuapp.com/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Wikipedia Live Monitor</a>. The code for which is also available on <a href="https://github.com/tomayac/wikipedia-live-monitor" data-href="https://github.com/tomayac/wikipedia-live-monitor" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Github</a>. I wish I had known about this earlier as it would have saved me much work— a reminder to leverage your social networks early in your thought process!</p><h4 name="07e3" id="07e3" class="graf graf--h4 graf-after--p">Planning</h4><p name="33a5" id="33a5" class="graf graf--p graf-after--h4">As developers, it’s important we scratch itches and follow our interests and write code. That’s when the most interesting things get built!</p><p name="1dd0" id="1dd0" class="graf graf--p graf-after--p">Looking back, however, I wish I’d made use of a lot of that energy and enthusiasm to do the non-technical work such as talking to product owners and drafting product proposals in time for annual planning.</p><h4 name="0f30" id="0f30" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">Scaling for Wikipedia’s traffic</strong></h4><p name="3359" id="3359" class="graf graf--p graf-after--h4">It’s never good to deploy a prototype, so when the iOS team asked to incorporate the service into their app, I started again with a greater attention for performance, scaling to Wikipedia’s traffic and reliability.</p><p name="99b3" id="99b3" class="graf graf--p graf-after--p">Using the node libraries I’d already written, it was reasonably low effort but there were complications in how we scaled the service and how data was collated.</p><p name="dd7d" id="dd7d" class="graf graf--p graf-after--p">For my prototype, to allow for reboots of the server, I cached activity periodically throughout the day in a JSON file using a <a href="https://github.com/Level/levelup" data-href="https://github.com/Level/levelup" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">level-up store</a>. However, when scaling for production, given we were running concurrent services on different machines, managing a cache in a single file on a single machine was not going to work. Instead we were able to replay an entire 24 hour period of edit events via <a href="https://en.wikipedia.org/wiki/Apache_Kafka" data-href="https://en.wikipedia.org/wiki/Apache_Kafka" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Apache Kafka</a>. We started small, only replaying 4 hours of editors and found that even with all the edits occuring on Wikipedia, we were able to replay a 24 hour period.</p><p name="a934" id="a934" class="graf graf--p graf-after--p graf--trailing">In my prototype, I used the <a href="https://wikitech.wikimedia.org/wiki/EventStreams" data-href="https://wikitech.wikimedia.org/wiki/EventStreams" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Wikimedia EventStreams service</a>. If you’re interested in working with this data or any of the libraries I’ve written — and provided you are not a top ten website — the EventStreams service should be more than enough for your needs.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@dlyall" class="p-author h-card">Jon Robson (David Lyall)</a> on <a href="https://medium.com/p/6ea5a6541fa5"><time class="dt-published" datetime="2018-03-14T14:01:01.245Z">March 14, 2018</time></a>.</p><p><a href="https://medium.com/@dlyall/failing-at-pushing-a-wikipedia-trending-api-6ea5a6541fa5" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on January 14, 2020.</p></footer></article></body></html>