<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>We’re going on a bug hunt (we’re not scared!)</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">We’re going on a bug hunt (we’re not scared!)</h1>
</header>
<section data-field="subtitle" class="p-summary">
Using statsv for client-side error reporting
</section>
<section data-field="body" class="e-content">
<section name="692f" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="b12f" id="b12f" class="graf graf--h3 graf--leading graf--title">We’re going on a bug hunt (we’re not scared!)</h1><h2 name="c410" id="c410" class="graf graf--h4 graf-after--h3 graf--subtitle">Using statsv for JavaScript error reporting</h4><p name="b983" id="b983" class="graf graf--p graf-after--h4">What happens when you have a bunch of JavaScript developers frustrated by not having any JavaScript error reporting in production? They find an unexpected workaround using the tooling they have available.</p><h1 name="123c" id="123c" class="graf graf--h3 graf-after--p">Coding in the dark</h1><p name="a94e" id="a94e" class="graf graf--p graf-after--h3">Wikipedia and its sister sites currently have no JavaScript error reporting. We have been using <a href="https://www.elastic.co/products/logstash" data-href="https://www.elastic.co/products/logstash" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">logstash</a> for tracking server errors, but due to the fact we are a small volunteer-based non-profit supporting a top-10 website, some essential parts of the infrastructure end up being de-prioritized. As a result, every change we make has a high risk of causing errors. We lean heavily on <a href="https://www.mediawiki.org/wiki/Manual:JavaScript_unit_testing" data-href="https://www.mediawiki.org/wiki/Manual:JavaScript_unit_testing" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">JavaScript unit tests</a>, <a href="https://www.mediawiki.org/wiki/Selenium" data-href="https://www.mediawiki.org/wiki/Selenium" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Selenium integration</a> tests, and <a href="https://jenkins.io/" data-href="https://jenkins.io/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Jenkins automation servers</a> to prevent this as much as possible, but we can never be 100% sure that what we ship is bug-free.</p><p name="61f8" id="61f8" class="graf graf--p graf-after--p">Our team is currently in the process of investing in <a href="https://www.mediawiki.org/wiki/Reading/Web/Projects/Invest_in_the_MobileFrontend_%26_MinervaNeue_frontend_architecture/Progress?useskin=vector" data-href="https://www.mediawiki.org/wiki/Reading/Web/Projects/Invest_in_the_MobileFrontend_%26_MinervaNeue_frontend_architecture/Progress?useskin=vector" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">the front-end architecture of our mobile sites</a>. The work is based on some tooling experiments that the same team performed earlier during the implementation of <a href="https://medium.com/p/d5bd734df8fe?source=your_stories_page---------------------------" data-href="https://medium.com/p/d5bd734df8fe?source=your_stories_page---------------------------" class="markup--anchor markup--p-anchor" target="_blank">the page previews feature</a>, <a href="https://phabricator.wikimedia.org/phame/post/view/93/extension_popups_page_previews_front-end_tooling/" data-href="https://phabricator.wikimedia.org/phame/post/view/93/extension_popups_page_previews_front-end_tooling/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">nicely summarized by Joaquin Hernandez</a>. While many of the ideas and lessons learned in that project apply here, there was one big difference that concerned us — rather than building something new we were refactoring a large codebase with technical debt that already lived in production.</p><p name="34dd" id="34dd" class="graf graf--p graf-after--p">The lack of client-side error reporting was concerning us, as the changes we were making were quite ambitious, and we were concerned that while making those changes, the likelihood of bugs would increase. <a href="https://sentry.io/" data-href="https://sentry.io/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Sentry</a> was identified as a potential solution to this problem <a href="https://phabricator.wikimedia.org/T106915" data-href="https://phabricator.wikimedia.org/T106915" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">back in June 2015</a>, but the work involved in that is non-trivial and spans many teams of various disciplines and we haven’t yet been able to find the bandwidth to work on this.</p><p name="7125" id="7125" class="graf graf--p graf-after--p">Rather than being put off by this, our team realized we could use our existing infrastructure to somewhat help with this situation. We currently use <a href="https://wikitech.wikimedia.org/wiki/Graphite#statsv" data-href="https://wikitech.wikimedia.org/wiki/Graphite#statsv" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">statsv</a> (an HTTP beacon endpoint) to send data to <a href="https://wikitech.wikimedia.org/wiki/Graphite" data-href="https://wikitech.wikimedia.org/wiki/Graphite" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Graphite</a> (a real-time graph) as a lightweight way of collecting interesting data about our clients. We use this to plot Grafana graphs that provide <a href="https://grafana.wikimedia.org/d/000000566/overview?orgId=1" data-href="https://grafana.wikimedia.org/d/000000566/overview?orgId=1" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">at a glance metrics</a> to allow monitoring of things such as <a href="https://grafana.wikimedia.org/d/000000566/overview?panelId=2&amp;fullscreen&amp;orgId=1" data-href="https://grafana.wikimedia.org/d/000000566/overview?panelId=2&amp;fullscreen&amp;orgId=1" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">opting into our mobile beta</a> and <a href="https://grafana.wikimedia.org/d/000000566/overview?panelId=16&amp;fullscreen&amp;orgId=1" data-href="https://grafana.wikimedia.org/d/000000566/overview?panelId=16&amp;fullscreen&amp;orgId=1" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">errors with A/B test instrumentation</a>. We check these often <a href="https://medium.com/freely-sharing-the-sum-of-all-knowledge/why-all-developers-should-do-their-chores-feafe33fecfa" data-href="https://medium.com/freely-sharing-the-sum-of-all-knowledge/why-all-developers-should-do-their-chores-feafe33fecfa" class="markup--anchor markup--p-anchor" target="_blank">using a chore rota</a>. We figured, that at the very least, we could <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">count </em></strong>JavaScript errors and use that as a metric for the quality of our output. On the long-term, having such data would allow us to put together a case study detailing the importance of such tooling in our infrastructure, by linking it back to our users and the initiatives our donors were kindly funding.</p><p name="7d05" id="7d05" class="graf graf--p graf-after--p">The code was simple — if an error happens on the client, increment a counter.</p><h1 name="6ee4" id="6ee4" class="graf graf--h3 graf-after--p">Coding with the statsv light on</h1><p name="2420" id="2420" class="graf graf--p graf-after--h3">Turning the error logging on was a little daunting, as we had no idea how buggy our mobile sites were. We limited our change to the mobile site only (<a href="https://medium.com/freely-sharing-the-sum-of-all-knowledge/why-does-wikipedia-in-2018-have-a-mobile-site-and-a-desktop-site-67898daee1ad" data-href="https://medium.com/freely-sharing-the-sum-of-all-knowledge/why-does-wikipedia-in-2018-have-a-mobile-site-and-a-desktop-site-67898daee1ad" class="markup--anchor markup--p-anchor" target="_blank">we run a separate mobile site</a>, so were able to separate this change from traffic for our desktop users) and added an off switch in case the situation was direr than our optimism hoped.</p><p name="1b76" id="1b76" class="graf graf--p graf-after--p">We enabled error counting on the 18th October and the errors starting rolling in (30,000 in the first five minutes). Our page views tend to fluctuate during a week, so we waited to collect a week&#39;s worth of data before drawing any conclusions. Within a week, the errors had peaked at 50,000 in a five minute period, so we now had a baseline. While high our site receives billions of monthly mobile page views so that’s not too bad.</p><figure name="39ea" id="39ea" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 605px; max-height: 363px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 60%;"></div><img class="graf-image" data-image-id="1*RHmcCwrA84XbEyHVrErE5g.png" data-width="605" data-height="363" src="https://cdn-images-1.medium.com/max/800/1*RHmcCwrA84XbEyHVrErE5g.png"></div><figcaption class="imageCaption">Client side errors were finally visible on our mobile site. This graph shows a 90 day period and clearly identifies where errors were introduced. [Screenshot of <a href="https://grafana.wikimedia.org" data-href="https://grafana.wikimedia.org" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Grafana</a>, own work, <a href="https://en.wikipedia.org/wiki/en:Creative_Commons" data-href="https://en.wikipedia.org/wiki/en:Creative_Commons" class="markup--anchor markup--figure-anchor" title="w:en:Creative Commons" rel="noopener nofollow noopener noopener" target="_blank">Creative Commons</a> <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" data-href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" class="markup--anchor markup--figure-anchor" rel="nofollow noopener noopener noopener noopener nofollow noopener noopener noopener" target="_blank">Attribution-Share Alike 3.0 Unported</a> license.]</figcaption></figure><p name="7426" id="7426" class="graf graf--p graf-after--figure">However, then, on the 26th October, we had a new problem to solve.</p><figure name="a898" id="a898" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 481px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 68.7%;"></div><img class="graf-image" data-image-id="1*Hl69gPmZKQLf1IqHnxCm0w.png" data-width="846" data-height="581" src="https://cdn-images-1.medium.com/max/800/1*Hl69gPmZKQLf1IqHnxCm0w.png"></div><figcaption class="imageCaption">Our first error spike was pretty obvious. [Screenshot of <a href="https://grafana.wikimedia.org" data-href="https://grafana.wikimedia.org" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Grafana</a>, own work, <a href="https://en.wikipedia.org/wiki/en:Creative_Commons" data-href="https://en.wikipedia.org/wiki/en:Creative_Commons" class="markup--anchor markup--figure-anchor" title="w:en:Creative Commons" rel="noopener nofollow noopener noopener" target="_blank">Creative Commons</a> <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" data-href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" class="markup--anchor markup--figure-anchor" rel="nofollow noopener noopener noopener noopener nofollow noopener noopener noopener" target="_blank">Attribution-Share Alike 3.0 Unported</a> license.]</figcaption></figure><p name="d680" id="d680" class="graf graf--p graf-after--figure">On the 26th, the errors spiked. As part of our team chores, we opened a new bug ticket to track the problem. On average, we were now seeing 50,000 every five minutes — several magnitudes more than before. It was clear that <em class="markup--em markup--p-em">something </em>had broken, but we had no idea <em class="markup--em markup--p-em">what</em> had broken. After all, all we were doing was <em class="markup--em markup--p-em">counting</em> errors. We had no knowledge of the <a href="https://en.wikipedia.org/wiki/Stack_trace" data-href="https://en.wikipedia.org/wiki/Stack_trace" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">stack traces </a>which would help us identify what code was causing the error and didn’t even know the language, URL or web browser it was happening on! Obviously, we knew this before enabling this metric and supposedly had made peace with this, only there was one thing we hadn’t counted on. We were developers...</p><h1 name="5f5f" id="5f5f" class="graf graf--h3 graf-after--p">Using the tooling we had to track down the error</h1><p name="6131" id="6131" class="graf graf--p graf-after--h3">For some reason, whenever hit with a problem, with the odds stacked against me, I’m always drawn to the childhood classic “<a href="https://en.wikipedia.org/wiki/We%27re_Going_on_a_Bear_Hunt" data-href="https://en.wikipedia.org/wiki/We%27re_Going_on_a_Bear_Hunt" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">We’re going on a bear hunt</a>” by <a href="https://en.wikipedia.org/wiki/Michael_Rosen" data-href="https://en.wikipedia.org/wiki/Michael_Rosen" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Michael Rosen</a> (adapted from an American folk song). That book instilled into me at an early age, that any problem can be overcome by thinking outside the box, even the unusual practice of hunting bears. If you’re a parent of young children, I thoroughly recommend you grab a copy.</p><p name="a4c7" id="a4c7" class="graf graf--p graf-after--p">When I became a developer, I would often channel Michael Rosen during conversations about scope creep or edge cases. If you’ve ever worked with a team of developers, especially if you are a product owner, you will have noticed that we are a curious bunch, and if you distract us with a shiny problem, we’ll bite, and even if you don’t want us to… <a href="https://blog.wikimedia.org/2017/06/15/mysterious-performance-improvement/" data-href="https://blog.wikimedia.org/2017/06/15/mysterious-performance-improvement/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">we’ll find the reason</a>.</p><figure name="54dc" id="54dc" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 266px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 37.9%;"></div><img class="graf-image" data-image-id="1*Qp4aQg2FdHLWIeiLEf_clQ.jpeg" data-width="2560" data-height="971" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*Qp4aQg2FdHLWIeiLEf_clQ.jpeg"></div><figcaption class="imageCaption"><a href="https://en.wikipedia.org/wiki/We%27re_Going_on_a_Bear_Hunt" data-href="https://en.wikipedia.org/wiki/We%27re_Going_on_a_Bear_Hunt" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">We’re going on a bear hunt</a> reminds us from an early age that any obstacles can be overcome if you think of them in different ways. [source: <a href="https://www.aliexpress.com/item/We-re-Going-on-a-Bear-Hunt-By-Michael-Rosen-English-Stories-Picture-card-Book-For/32861526133.html" data-href="https://www.aliexpress.com/item/We-re-Going-on-a-Bear-Hunt-By-Michael-Rosen-English-Stories-Picture-card-Book-For/32861526133.html" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">aliexpress</a>, Illustrations by <a href="https://en.wikipedia.org/wiki/Helen_Oxenbury" data-href="https://en.wikipedia.org/wiki/Helen_Oxenbury" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Helen Oxenbury</a>, license: fair use]</figcaption></figure><p name="9761" id="9761" class="graf graf--p graf-after--figure">So, hit with the problem of an additional 30,000 client-side errors over the period of five minutes, even though early on, we recognized that counting errors would only tell us “when” an error occurred rather than “why”, it seemed worthy of further investigation. The only question was how.</p><p name="1184" id="1184" class="graf graf--p graf-after--p">A work colleague outside our team in a casual conversation pointed out that statsv endpoints were GET requests, and thus went through <a href="https://wikitech.wikimedia.org/wiki/File:Pageview_@_Wikimedia_%28WMF_Analytics_lightning_talk,_June_2015%29.pdf?page=6" data-href="https://wikitech.wikimedia.org/wiki/File:Pageview_@_Wikimedia_(WMF_Analytics_lightning_talk,_June_2015).pdf?page=6" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">our infrastructure to count page views</a>. Armed with this information, it seemed we’d be able to glean some useful information about the errors we were seeing, based on data we were collecting for the purposes of monitoring site traffic.</p><p name="a707" id="a707" class="graf graf--p graf-after--p">Although we were only <em class="markup--em markup--p-em">counting</em> client-side errors, each of the requests being made to our statsv beacon to count these errors had a host of meta-data associated — notably, the Wikipedia language and domain that was being used; the referrer URL and most importantly the user browser agent.</p><figure name="2dc5" id="2dc5" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 525px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><img class="graf-image" data-image-id="1*kpCiPunkvFswb1bbzc8Ocg.jpeg" data-width="800" data-height="600" src="https://cdn-images-1.medium.com/max/800/1*kpCiPunkvFswb1bbzc8Ocg.jpeg"></div><figcaption class="imageCaption">How we collect page views. [Wikimedia Foundation / Joseph Allemandou <a href="https://en.wikipedia.org/wiki/en:Creative_Commons" data-href="https://en.wikipedia.org/wiki/en:Creative_Commons" class="markup--anchor markup--figure-anchor" title="w:en:Creative Commons" rel="noopener nofollow noopener noopener noopener" target="_blank">Creative Commons</a> <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" data-href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" class="markup--anchor markup--figure-anchor" rel="nofollow noopener noopener noopener noopener nofollow noopener noopener noopener noopener" target="_blank">Attribution-Share Alike 3.0 Unported</a> license.]</figcaption></figure><p name="adeb" id="adeb" class="graf graf--p graf-after--figure">By looking at the client side errors for a single day, we could run a series of <a href="https://en.wikipedia.org/wiki/Apache_Hive" data-href="https://en.wikipedia.org/wiki/Apache_Hive" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Apache Hive</a> queries to give more context on the errors we were collecting for a single day. I did just that, to see if I could glean any further information. I ran the following Hive queries:</p><pre name="2910" id="2910" class="graf graf--pre graf-after--p">#ALL ERRORS grouped by project:</pre><pre name="c3e4" id="c3e4" class="graf graf--pre graf-after--pre">select uri_host,namespace_id,count(*) from webrequest where day = 30 and month = 10 and year = 2018 and uri_path LIKE &#39;%beacon%&#39; and uri_query LIKE &quot;%WebClientError%&quot; group by uri_host,namespace_id;</pre><pre name="1484" id="1484" class="graf graf--pre graf-after--pre"># all errors grouped by user agent:<br>select uri_host,user_agent_map[&#39;os_family&#39;],user_agent_map[&#39;browser_family&#39;], count(*) from webrequest where day = 30 and month = 10 and year = 2018 and uri_path LIKE &#39;%beacon%&#39; and uri_query LIKE &quot;%WebClientError%&quot; group by uri_host,user_agent_map[&#39;os_family&#39;], user_agent_map[&#39;browser_family&#39;];</pre><pre name="a49a" id="a49a" class="graf graf--pre graf-after--pre"># all errors grouped by referrer:<br>select uri_host,referer, count(*) from webrequest where day = 30 and month = 10 and year = 2018 and uri_path LIKE &#39;%beacon%&#39; and uri_query LIKE &quot;%WebClientError%&quot; group by uri_host,referer;</pre><p name="8b70" id="8b70" class="graf graf--p graf-after--pre">Thankfully, these queries did help. While, grouping the errors by project did not shed much light, it ruled out the possibility that the bug was based on language or language-specific customizations. Likewise, grouping by referrer (e.g. the URL the user was on at the time they experienced the bug) showed no real trend — there were no problematic pages triggering more errors than the other. The user agent was the most valuable, the query helped me notice that the majority of the issues were coming from iOS (the iPhone), so I drilled down further looking at iOS by running the following Hive query:</p><pre name="8628" id="8628" class="graf graf--pre graf-after--p">select uri_host,user_agent_map[&#39;os_family&#39;],user_agent_map[&#39;browser_family&#39;],user_agent_map[&#39;browser_major&#39;], user_agent_map[&#39;os_major&#39;], count(*) from webrequest where day = 30 and month = 10 and year = 2018 and user_agent_map[&#39;browser_family&#39;] = &#39;Mobile Safari&#39; and uri_path LIKE &#39;%beacon%&#39; and uri_query LIKE &quot;%WebClientError%&quot; group by uri_host,user_agent_map[&#39;os_family&#39;], user_agent_map[&#39;browser_family&#39;], user_agent_map[&#39;browser_major&#39;], user_agent_map[&#39;os_major&#39;];</pre><p name="b3d8" id="b3d8" class="graf graf--p graf-after--pre">This Hive query showed me clearly that the bug was most prominent in iOS Safari (in fact 70% of all our errors were coming from this browser). Using <a href="https://browserstack.com" data-href="https://browserstack.com" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">browserstack</a> (a tool that allows cross-browser testing), and my knowledge of the mobile stack (and <a href="https://www.mediawiki.org/wiki/MediaWiki_1.33/wmf.1" data-href="https://www.mediawiki.org/wiki/MediaWiki_1.33/wmf.1" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">code that had recently changed in the deploy</a> that led to the bug), I took a look at one of the most common referrers and quickly I was able to replicate the bug quite quickly (on page load) — and thus hone in on the bug —<a href="https://phabricator.wikimedia.org/T208605" data-href="https://phabricator.wikimedia.org/T208605" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"> an issue with some JavaScript templating code</a>.</p><h1 name="49c3" id="49c3" class="graf graf--h3 graf-after--p">A happy ending</h1><p name="7129" id="7129" class="graf graf--p graf-after--h3">The bug was squashed promptly and the client side errors reverted back to its “normal” baseline shortly after we deployed the fix. We all sighed in relief.</p><p name="5db9" id="5db9" class="graf graf--p graf-after--p">One of the outcomes of our mobile site investment project is to improve test coverage. Not only had we shown that our error counting could identify new bugs, but we’d shown the impact of identifying and fixing existing bugs.</p><p name="845f" id="845f" class="graf graf--p graf-after--p">Since that issue in October, we’ve also identified two other issues via the same debugging method. In January we debugged and squash <a href="https://phabricator.wikimedia.org/T209882#4868432" data-href="https://phabricator.wikimedia.org/T209882#4868432" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">a much more impactful issue related to cached HTML</a> as well as an issue with a volunteer-run <a href="https://phabricator.wikimedia.org/T214330" data-href="https://phabricator.wikimedia.org/T214330" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">banner campaign</a>.</p><p name="f1e8" id="f1e8" class="graf graf--p graf-after--p">Hopefully, sometime soon, I can write about how Wikipedia has zero client-side errors.</p><figure name="4c9a" id="4c9a" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 319px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 45.6%;"></div><img class="graf-image" data-image-id="1*iLlr3Ti9u3BVUMBs-LbkmQ.png" data-width="1406" data-height="641" src="https://cdn-images-1.medium.com/max/800/1*iLlr3Ti9u3BVUMBs-LbkmQ.png"></div><figcaption class="imageCaption">The last 90 days have shown 2 eventful error spikes. The spikes upwards represent new errors and the spikes downwards represent fixes. The errors represent 100% of mobile’s client side errors [Screenshot of <a href="https://grafana.wikimedia.org" data-href="https://grafana.wikimedia.org" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Grafana</a>, own work, <a href="https://en.wikipedia.org/wiki/en:Creative_Commons" data-href="https://en.wikipedia.org/wiki/en:Creative_Commons" class="markup--anchor markup--figure-anchor" title="w:en:Creative Commons" rel="noopener nofollow noopener noopener noopener" target="_blank">Creative Commons</a> <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" data-href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" class="markup--anchor markup--figure-anchor" rel="nofollow noopener noopener noopener noopener nofollow noopener noopener noopener noopener" target="_blank">Attribution-Share Alike 3.0 Unported</a> license.]</figcaption></figure><h1 name="cf90" id="cf90" class="graf graf--h3 graf-after--figure">Takeaways</h1><p name="b056" id="b056" class="graf graf--p graf-after--h3">Obviously, counting errors with statsv is not a sustainable way to run a website, and if you are being sent to this URI being told that you need to install statsv to count errors immediately, please kindly point that person to this section. If you want to count errors and have the resourcing to do such a thing, I highly recommend <a href="https://github.com/getsentry/sentry-javascript" data-href="https://github.com/getsentry/sentry-javascript" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Sentry</a> and/or its client-side SDK. The Wikimedia Foundation needs to get Sentry up and running, and we will catch up with doing that at some point in the future as soon as we can herd the correct team of people together.</p><p name="2e33" id="2e33" class="graf graf--p graf-after--p">So, what is the point of this article, if not to tell you about how to debug errors with statvs? Maybe it’s a reminder that engineers are paid to solve problems and that sometimes, being an engineer involves thinking outside the box and using the tooling you already have in creative unexpected ways. When we set out to count errors, as engineers we were not satisfied that it was the right way forward, but given it was low effort, we’ve already justified that work and more.</p><p name="a422" id="a422" class="graf graf--p graf-after--p">In this particular case, doing something unexpected with inappropriate tooling, was a great way to help non-technical people understand why JavaScript errors were something we should be capturing by making a hidden and unknown problem visible.</p><p name="e2ac" id="e2ac" class="graf graf--p graf-after--p graf--trailing">As anyone who has gone on a bear hunt will tell you, mountain-like problems can always be climbed given enough time and in absence of a bridge through the middle, while it’s tempting to give up altogether, sometimes we need to find other ways to get our message through.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@dlyall" class="p-author h-card">Jon Robson (David Lyall)</a> on <a href="https://medium.com/p/b4057e4a91d2"><time class="dt-published" datetime="2019-02-11T15:01:00.877Z">February 11, 2019</time></a>.</p><p><a href="https://medium.com/@dlyall/were-going-on-a-bug-hunt-we-re-not-scared-b4057e4a91d2" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on January 14, 2020.</p></footer></article></body></html>